<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.2.0">
<title>pg_listen</title>
<meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79">
<link rev="MADE" href="mailto:pgsql-docs@postgresql.org">
<link rel="HOME" title="PostgreSQL Tcl Interface Documentation" href="index.html">
<link rel="UP" title="pgtcl Command Reference" href="libpgtcl-ref.html">
<link rel="PREVIOUS" title="pg_execute" href="pgtcl-pgexecute.html">
<link rel="NEXT" title="pg_on_connection_loss" href="pgtcl-pgon-connection-loss.html">
<link rel="STYLESHEET" type="text/css" href="stylesheet.css">
</head>
<body class="REFENTRY">
<div class="NAVHEADER">
<table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<th colspan="5" align="center" valign="bottom">PostgreSQL Tcl Interface Documentation</th>
</tr>
<tr>
<td width="10%" align="left" valign="top"><a href="pgtcl-pgexecute.html" accesskey="P">Prev</a></td>
<td width="10%" align="left" valign="top"><a href="pgtcl-pgexecute.html">Fast Backward</a></td>
<td width="60%" align="center" valign="bottom"></td>
<td width="10%" align="right" valign="top"><a href="pgtcl-pgon-connection-loss.html">Fast Forward</a></td>
<td width="10%" align="right" valign="top"><a href="pgtcl-pgon-connection-loss.html" accesskey="N">Next</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
<h1><a name="PGTCL-PGLISTEN" id="PGTCL-PGLISTEN"></a>pg_listen</h1>
<div class="REFNAMEDIV"><a name="AEN1284" id="AEN1284"></a>
<h2>Name</h2>
pg_listen&nbsp;--&nbsp;set or change a callback for asynchronous notification messages<a name="IX-PGTCL-PGLISTEN-2" id="IX-PGTCL-PGLISTEN-2"></a></div>
<div class="REFSYNOPSISDIV"><a name="AEN1289" id="AEN1289"></a>
<h2>Synopsis</h2>
<pre class="SYNOPSIS">pg_listen <code class="PARAMETER">conn</code> <code class="PARAMETER">notifyName</code> ?<span class="OPTIONAL"><code class="PARAMETER">callbackCommand</code></span>?</pre></div>
<div class="REFSECT1"><a name="AEN1295" id="AEN1295"></a>
<h2>Description</h2>
<p><code class="FUNCTION">pg_listen</code> creates, changes, or cancels a request to listen for asynchronous notification messages from the <span class="PRODUCTNAME">PostgreSQL</span> server. With a <code class="PARAMETER">callbackCommand</code> parameter, the request is established, or the command string of an already existing request is replaced. With no <code class="PARAMETER">callbackCommand</code> parameter, a prior request is canceled.</p>
<p>After a <code class="FUNCTION">pg_listen</code> request is established, the specified command string is executed whenever a notification message bearing the given name arrives from the server. This occurs when any <span class="PRODUCTNAME">PostgreSQL</span> client application issues a <tt class="COMMAND">NOTIFY</tt><a name="AEN1306" id="AEN1306"></a> command referencing that name. The command string is executed from the Tcl idle loop. That is the normal idle state of an application written with Tk. In non-Tk Tcl shells, you can execute <code class="FUNCTION">update</code> or <code class="FUNCTION">vwait</code> to cause the idle loop to be entered.</p>
<p>You should not invoke the SQL statements <tt class="COMMAND">LISTEN</tt> or <tt class="COMMAND">UNLISTEN</tt> directly when using <code class="FUNCTION">pg_listen</code>. <span class="APPLICATION">pgtcl</span> takes care of issuing those statements for you. But if you want to send a notification message yourself, invoke the SQL <tt class="COMMAND">NOTIFY</tt> statement using <code class="FUNCTION">pg_exec</code>.</p>
</div>
<div class="REFSECT1"><a name="AEN1318" id="AEN1318"></a>
<h2>Arguments</h2>
<div class="VARIABLELIST">
<dl>
<dt><code class="PARAMETER">conn</code></dt>
<dd>
<p>The handle of the connection on which to listen for notifications.</p>
</dd>
<dt><code class="PARAMETER">notifyName</code></dt>
<dd>
<p>The name of the notification condition to start or stop listening to.</p>
</dd>
<dt><code class="PARAMETER">callbackCommand</code></dt>
<dd>
<p>If present, provides the command string to execute when a matching notification arrives.</p>
</dd>
</dl>
</div>
</div>
<div class="REFSECT1"><a name="AEN1336" id="AEN1336"></a>
<h2>Return Value</h2>
<p>None</p>
</div>
<div class="NAVFOOTER">
<hr align="left" width="100%">
<table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="33%" align="left" valign="top"><a href="pgtcl-pgexecute.html" accesskey="P">Prev</a></td>
<td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>
<td width="33%" align="right" valign="top"><a href="pgtcl-pgon-connection-loss.html" accesskey="N">Next</a></td>
</tr>
<tr>
<td width="33%" align="left" valign="top">pg_execute</td>
<td width="34%" align="center" valign="top"><a href="libpgtcl-ref.html" accesskey="U">Up</a></td>
<td width="33%" align="right" valign="top">pg_on_connection_loss</td>
</tr>
</table>
</div>
</body>
</html>
